<mxfile host="Electron" agent="Mozilla/5.0 (Macintosh; Intel Mac OS X 10_15_7) AppleWebKit/537.36 (KHTML, like Gecko) draw.io/26.0.9 Chrome/128.0.6613.186 Electron/32.2.5 Safari/537.36" version="26.0.9">
  <diagram name="第 1 页" id="ZSY5leRc2CrwL5IrsEqy">
    <mxGraphModel dx="1026" dy="743" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-51" value="" style="group;strokeWidth=2;" vertex="1" connectable="0" parent="1">
          <mxGeometry x="28" y="470" width="770" height="130" as="geometry" />
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-42" value="KEM 接口层" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontSize=17;fontStyle=1;strokeColor=default;arcSize=5;absoluteArcSize=0;container=0;strokeWidth=2;" vertex="1" parent="TEWdbiPsKBLDxlEcTMhJ-51">
          <mxGeometry width="770" height="130" as="geometry" />
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-43" value="&lt;b&gt;KEM 接口&lt;/b&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;div&gt;&lt;div&gt;GenerateKeyPair&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;Encapsulate/Decapsulate&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: transparent; color: light-dark(rgb(0, 0, 0), rgb(255, 255, 255));&quot;&gt;ParseKey&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;imageHeight=24;arcSize=5;container=0;strokeWidth=2;" vertex="1" parent="TEWdbiPsKBLDxlEcTMhJ-51">
          <mxGeometry x="20" y="40" width="161" height="80" as="geometry" />
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-44" value="&lt;b&gt;OW-ChCCA KEM&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;imageHeight=24;arcSize=5;container=0;strokeWidth=2;" vertex="1" parent="TEWdbiPsKBLDxlEcTMhJ-51">
          <mxGeometry x="211" y="40" width="160" height="80" as="geometry" />
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-48" value="&lt;b&gt;(N,u)-OW-PCA KEM&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;imageHeight=24;arcSize=5;container=0;strokeWidth=2;" vertex="1" parent="TEWdbiPsKBLDxlEcTMhJ-51">
          <mxGeometry x="400" y="40" width="161" height="80" as="geometry" />
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-49" value="&lt;b&gt;其他 KEM 实现&lt;/b&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;&lt;div&gt;ML-KEM, Hybrid-KEM&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;imageHeight=24;arcSize=5;container=0;strokeWidth=2;" vertex="1" parent="TEWdbiPsKBLDxlEcTMhJ-51">
          <mxGeometry x="591" y="40" width="160" height="80" as="geometry" />
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-53" value="密码原语层" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontSize=17;fontStyle=1;strokeColor=default;arcSize=5;absoluteArcSize=0;container=0;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="30" y="620" width="770" height="130" as="geometry" />
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-54" value="&lt;b&gt;哈希函数&lt;/b&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;div&gt;H1/H2（基于SHA3)&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;imageHeight=24;arcSize=5;container=0;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="49" y="660" width="191" height="80" as="geometry" />
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-55" value="&lt;b&gt;对称加密&lt;/b&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;AES-GCM&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;imageHeight=24;arcSize=5;container=0;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="320" y="660" width="190" height="80" as="geometry" />
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-56" value="&lt;b&gt;随机数生成&lt;/b&gt;&lt;div&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;/div&gt;&lt;div&gt;密码学安全随机数源(Go/crypto)&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;imageHeight=24;arcSize=5;container=0;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="590" y="660" width="189" height="80" as="geometry" />
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-23" value="协议核心层" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontSize=17;fontStyle=1;strokeColor=default;arcSize=5;absoluteArcSize=0;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="29" y="300" width="770" height="150" as="geometry" />
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-26" value="&lt;b&gt;&lt;font&gt;会话状态管理&lt;/font&gt;&lt;/b&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;div&gt;&lt;div&gt;&lt;div&gt;Statelnitial StateAwaitingResponse&lt;/div&gt;&lt;div&gt;StateEstablished&lt;/div&gt;&lt;div&gt;StateFailed&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;imageHeight=24;arcSize=5;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="49" y="340" width="160" height="100" as="geometry" />
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-37" value="&lt;b&gt;阶段一密钥交换&lt;/b&gt;&lt;br&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;div&gt;&lt;div&gt;生成/解析临时密钥&lt;/div&gt;&lt;div&gt;KEM1封装/解封装&lt;/div&gt;&lt;div&gt;生成临时密钥K_tmp&lt;/div&gt;&lt;div&gt;0-RTT加密/解密&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;imageHeight=24;arcSize=5;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="239" y="340" width="160" height="100" as="geometry" />
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-38" value="&lt;b&gt;阶段二密钥交换&lt;/b&gt;&lt;br&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;div&gt;&lt;div&gt;KEM2封装/解封装&lt;/div&gt;&lt;div&gt;密文C2交换&lt;/div&gt;&lt;div&gt;生成会话密钥K_main&lt;/div&gt;&lt;div&gt;应用数据加密/解密&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;imageHeight=24;arcSize=5;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="429" y="340" width="160" height="100" as="geometry" />
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-39" value="&lt;b&gt;配置管理&lt;/b&gt;&lt;br&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;div&gt;&lt;div&gt;KEM算法选择&lt;/div&gt;&lt;div&gt;安全参数配置&lt;/div&gt;&lt;div&gt;密钥长度设置&lt;/div&gt;&lt;div&gt;加密算法选择&lt;/div&gt;&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;imageHeight=24;arcSize=5;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="619" y="340" width="160" height="100" as="geometry" />
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-1" value="应用层" style="rounded=1;whiteSpace=wrap;html=1;verticalAlign=top;fontSize=17;fontStyle=1;strokeColor=default;arcSize=5;absoluteArcSize=0;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="30" y="140" width="770" height="140" as="geometry" />
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-6" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;" edge="1" parent="1" source="TEWdbiPsKBLDxlEcTMhJ-2" target="TEWdbiPsKBLDxlEcTMhJ-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-11" value="ClientHello+0-RTT" style="edgeLabel;html=1;align=center;verticalAlign=bottom;resizable=0;points=[];fontSize=12;" vertex="1" connectable="0" parent="TEWdbiPsKBLDxlEcTMhJ-6">
          <mxGeometry relative="1" as="geometry">
            <mxPoint y="-5" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-2" value="&lt;b&gt;客户端（Client）&lt;/b&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;div&gt;生成 ClientHello&lt;/div&gt;&lt;div&gt;处理 ServerResponse&lt;/div&gt;&lt;div&gt;加密/解密应用数据&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;imageHeight=24;arcSize=5;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="50" y="180" width="160" height="80" as="geometry" />
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-10" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.75;exitDx=0;exitDy=0;entryX=1;entryY=0.75;entryDx=0;entryDy=0;strokeWidth=2;" edge="1" parent="1" source="TEWdbiPsKBLDxlEcTMhJ-3" target="TEWdbiPsKBLDxlEcTMhJ-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-12" value="ServerResponse" style="edgeLabel;html=1;align=center;verticalAlign=top;resizable=0;points=[];fontSize=13;" vertex="1" connectable="0" parent="TEWdbiPsKBLDxlEcTMhJ-10">
          <mxGeometry relative="1" as="geometry">
            <mxPoint y="3" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-3" value="&lt;b&gt;消息序列化&lt;/b&gt;&lt;br&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;div&gt;MarshalClientHello&lt;/div&gt;&lt;div&gt;UnmarshalClientHello&lt;br&gt;&lt;/div&gt;&lt;div&gt;MarshalServerResponse&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;imageHeight=24;arcSize=5;spacing=2;spacingBottom=0;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="330" y="180" width="160" height="80" as="geometry" />
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-5" value="&lt;b&gt;服务器（Server）&lt;/b&gt;&lt;div&gt;&lt;b&gt;&lt;br&gt;&lt;/b&gt;&lt;div&gt;处理 ClientHello&lt;/div&gt;&lt;div&gt;生成 ServerResponse&lt;/div&gt;&lt;div&gt;加密/解密应用数据&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;align=center;imageHeight=24;arcSize=5;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="610" y="180" width="160" height="80" as="geometry" />
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="490" y="219.5" as="sourcePoint" />
            <mxPoint x="610" y="219.5" as="targetPoint" />
          </mxGeometry>
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-15" value="ClientHello+0-RTT" style="edgeLabel;html=1;align=center;verticalAlign=bottom;resizable=0;points=[];fontSize=12;" vertex="1" connectable="0" parent="TEWdbiPsKBLDxlEcTMhJ-14">
          <mxGeometry relative="1" as="geometry">
            <mxPoint y="-5" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-18" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=0;exitY=0.75;exitDx=0;exitDy=0;entryX=1;entryY=0.75;entryDx=0;entryDy=0;strokeWidth=2;" edge="1" parent="1">
          <mxGeometry relative="1" as="geometry">
            <mxPoint x="610" y="240" as="sourcePoint" />
            <mxPoint x="490" y="240" as="targetPoint" />
            <Array as="points">
              <mxPoint x="560" y="240" />
              <mxPoint x="560" y="240" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="TEWdbiPsKBLDxlEcTMhJ-19" value="ServerResponse" style="edgeLabel;html=1;align=center;verticalAlign=top;resizable=0;points=[];fontSize=13;" vertex="1" connectable="0" parent="TEWdbiPsKBLDxlEcTMhJ-18">
          <mxGeometry relative="1" as="geometry">
            <mxPoint y="3" as="offset" />
          </mxGeometry>
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
